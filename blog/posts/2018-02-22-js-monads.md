
Üdv!

Kipróbáltam, hogy hogy működne a sitedoc a Sógunos modulokban. Az lenne a cél, hogy egy bounded contextnek egy sitedocja
legyen, ne legyen szétszórva az infó az almodulokban.

A PoC-ben van egy többszintű aggregátor POM, és a legfelső szinten generáljuk a sitedocot. Az API dokumentáció
generálása (itt most TypeDoc), viszont a gyerek pomokban történik, mivel ott van a forrás. A legfelső sitedoc menüjébe
vannak belinkelve az API dokumentációk.

Sajnos a jelenlegi konvenció a site URL-re ezt nem teszi lehetővé, mivel a jelenlegi struktúra lapos, és mindegyik
URL-ben benne van az artifact verziója, az artifact neve után, így:

```xml
<url>${site.distribution.base.url}/${project.groupId}/${project.artifactId}/${sitedoc-version}</url>
```

Úgy tapasztaltam, hogy a Site csak akkor aggregálja össze a fájlokat, ha a szülő site URL-jét tartalmazza a gyerek
URL-je. Az aggregálás meg szükséges ahhoz, hogy relatív linkeket tudjunk használni a site XML-ekben.

A következőképpen orvosoltam a problémát:

A legfelső modul URL-je továbbra is ugyanaz marad:
```xml
<!-- site url of shogun-codeorg-demo -->
<url>${site.distribution.base.url}/${project.groupId}/shogun-codeorg-demo/${sitedoc-version}</url>
```

A gyerekek site URL-je meg a következőképpen változik:

```
<!-- site url of shogun-codeorg-demo-web-domain -->
<url>${site.distribution.base.url}/${project.groupId}/shogun-codeorg-demo/${sitedoc-version}/frontend/web/domain</url>

```

És így a shogun-codeorg-demo site XML-jében be tudjunk linkelni a menübe:

```xml
<item name="Domain Layer (TypeDoc)" href="frontend/web/domain/typedoc/index.html" />
```

Mivel a szülő modul URL-je szerepel a gyerek modul URL-jében, ezért a `mvn site:stage` oda fogja másolni alá, és el
lehet érni a relatív linkkel.

A szépséghibája a dolognak, hogy a gyerekmodulokban csak a `site.distribution.base.url` és a `project.groupId` propertyt
tudjuk behelyettesíteni, a többit hardkódolni kell. De szerintem nem olyan nagy gond ez, mert egyszer kell megcsinálni
a POM-ot, amikor elindul egy modul, illetve lehet hozzá írni archetype-ot.

Jelenleg az artifactverifier tiltja ezt, úgyhogy ha úgy döntünk, hogy ez jó, akkor engedélyezni kéne, de valahogy úgy,
hogy a régi fajta moduloknál továbbra is kikényszerítse, illetve az al-URL-ek helyességét is ellenőrizze.

Itt van a [PoC][1].

Jó lesz így?

[1]: https://scm-git-eur.misys.global.ad/projects/FBEOW/repos/demo-shogun-codeorg-demo/pull-requests/1/diff

Minden jót,
Sevcsik-Zajácz

<!--stackedit_data:
eyJoaXN0b3J5IjpbMTM3MzAwMjA5MCwtMTEwODAwODQxMV19
-->